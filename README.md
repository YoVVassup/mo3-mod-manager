<p align="center">
	<a href="https://github.com/YoVVassup/mo3-mod-manager">
		<img src="https://github.com/YoVVassup/mo3-mod-manager/blob/master/logo.png" alt="Mo3ModManager Logo">
	</a>
</p>

# Mo3ModManager

Mo3ModManager — это менеджер модов для игры Mental Omega, разработанный для упрощения управления и запуска различных модификаций. Приложение использует технологию жестких ссылок NTFS для эффективного управления файлами модов и профилей, обеспечивая при этом гибкость и совместимость с различными версиями Windows.

## О проекте

Этот проект представляет собой WPF-приложение на C#, предназначенное для:

* **Управления модами:** Позволяет пользователям просматривать, устанавливать и удалять моды для Mental Omega (и почти любых модификаций Red Alert 2: Yuri's Revenge).

* **Управления профилями:** Создание и управление игровыми профилями, каждый из которых может иметь свой набор модов и сохранений.

* **Эффективного использования дискового пространства:** Использует жесткие ссылки NTFS для предотвращения дублирования файлов, когда несколько модов или профилей используют одни и те же базовые игровые файлы.

* **Поддержки различных версий Windows:** Совместимость с Windows XP, Windows Vista, Windows 7, Windows 8, Windows 8.1 и Windows 10.

* **Запуска игр с повышенными привилегиями:** Приложение запрашивает права администратора для выполнения операций с файлами и жесткими ссылками.

## Особенности

* **Интуитивно понятный интерфейс:** Простой и понятный пользовательский интерфейс для навигации по модам и профилям.

* **Отображение информации о моде:** При выборе мода в `TreeView` отображается его описание и изображение.

* **Масштабируемые изображения:** Изображения модов адаптируются к размеру окна, и их можно открыть в полном размере для детального просмотра.

* **Создание и удаление профилей:** Легкое создание новых игровых профилей и удаление существующих.

* **Установка модов из архивов:** Возможность установки модов из `.zip` архивов.

* **Очистка каталогов:** Автоматическая очистка временных и рабочих каталогов после завершения игровых сессий.

* **Локализация:** Поддержка русского языка для пользовательского интерфейса и сообщений.

## Требования

* **Операционная система:** Windows XP или новее (рекомендуется Windows 8 или новее для оптимальной работы менеджера процессов).

* **.NET Framework:** Требуется установленный .NET Framework (версия 4.0 или выше, в зависимости от целевой платформы проекта).

* **Права администратора:** Приложение требует прав администратора для создания жестких ссылок и управления файлами.

## Использование

1. **Запуск приложения:** Запустите `Mo3ModManager.exe`. Возможно, потребуется подтвердить запрос на повышение прав (UAC).

2. **Загрузка модов:** Убедитесь, что ваши файлы модов (каждый мод в отдельной папке с `node.json` и папкой `Files`) находятся в подкаталоге `Mods` относительно исполнимого файла менеджера.

   * **Установка новых модов:** Используйте кнопку "\_Установить мод..." для установки модов из `.zip` архивов.

3. **Выбор мода:** В левой части окна выберите нужный мод из списка. В правой части отобразится его описание и изображение.

4. **Просмотр изображения мода:** Нажмите на изображение мода, чтобы открыть его в программе просмотра изображений по умолчанию.

5. **Управление профилями:**

   * Создайте новый профиль, используя кнопку "\_Новый профиль...".

   * Выберите профиль из списка.

   * Используйте кнопки "\_Переименовать профиль..." и "\_Удалить профиль..." для управления профилями.

6. **Запуск игры:** Выберите мод и профиль, затем нажмите кнопку "\_Играть" для запуска игры с выбранным модом и профилем.

## Структура проекта

* `MainWindow.xaml` / `MainWindow.xaml.cs`: Главное окно приложения, содержит основную логику пользовательского интерфейса и обработчики событий.

* `Node.cs`: Класс, представляющий отдельный мод с его метаданными (идентификатор, имя, исполняемый файл, аргументы, описание и т.д.).

* `NodeTree.cs`: Класс для построения и управления иерархической структурой модов, загружаемых из каталога `Mods`.

* `ModItem.cs`: Вспомогательный класс для привязки данных к `TreeView`, представляющий мод в пользовательском интерфейсе.

* `ModProcessManager.cs`: Класс, отвечающий за подготовку среды выполнения игры (создание жестких ссылок, копирование профилей) и запуск процесса игры.

* `ModProcessManagerArguments.cs`: Класс для передачи аргументов в `ModProcessManager`.

* `ProfileItem.cs`: Класс, представляющий игровой профиль в пользовательском интерфейсе.

* `IO.cs`: Вспомогательный класс, содержащий статические методы для файловых операций, таких как создание жестких ссылок, очистка каталогов и определение одинаковых файлов.

* `Win32.cs`: Содержит P/Invoke декларации для вызова функций WinAPI, используемых для низкоуровневых операций с процессами и файловой системой (например, Job Objects, жесткие ссылки).

* `InputWindow.xaml` / `InputWindow.cs`: Вспомогательное окно для получения текстового ввода от пользователя.

* `app.manifest`: Манифест приложения, объявляющий требования к UAC (запрос прав администратора) и совместимость с версиями Windows.

* `AssemblyInfo.cs`: Содержит метаданные сборки, такие как название, версия и авторские права.

* `Resources.Designer.cs`: Автоматически генерируемый класс для доступа к локализованным ресурсам.

## Разработка

Для разработки или модификации проекта:

1. Откройте проект в Visual Studio.

2. Убедитесь, что все необходимые пакеты NuGet установлены (например, `Newtonsoft.Json` для парсинга `node.json`, `SharpZipLib` для работы с ZIP-архивами).

3. Выполните сборку решения, чтобы убедиться в отсутствии ошибок.

4. Проверяйте логи в окне "Вывод" (Output) Visual Studio для отладочной информации и предупреждений.

## Лицензия

* MIT

## Контакты

* Автор: Sad Pencil [me@pencil.live](mailto:me@pencil.live)

* Мод: YoWassup

---
*Этот `README.md` был сгенерирован автоматически на основе анализа исходного кода.*
